pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
--todo
---bronto at zoom x1
---pteros overhead at zoom x2
---continents and so on
---songs of death mugg
---lods?

stars={}
segs={}
⧗=0  --master timer
z⧗=0 --zoom timer
l⧗=0 --letters timer

earth2f=split("-4.780906,-21.800102,-4.772896,-21.539381,-4.550962,-21.777911,-4.32789,-21.650781,-4.360529,-21.450967,-4.159994,-21.30518,-3.995883,-21.527136,-3.905496,-21.768947,-3.947658,-22.040117,-3.450774,-22.075717,-3.18594,-22.000257,-3.134833,-21.882105,-3.22437,-21.725241,-3.053702,-21.615849,-3.037375,-21.487533,-3.356956,-21.235452,-3.616584,-21.144912,-3.832535,-21.188942,-3.866291,-21.043951,-4.063484,-20.647388,-4.281421,-20.413722,-4.581996,-20.343762,-4.743198,-20.192851,-4.747078,-19.998903,-5.001411,-19.920123,-5.271673,-19.631471,-5.524613,-19.24355,-5.622224,-18.979148,-5.643503,-18.601058,-5.278341,-18.602358,-5.027553,-18.077258,-4.665883,-18.202498,-4.163497,-18.139128,-3.667486,-17.931522,-3.312283,-17.899012,-2.995782,-17.808712,-2.229806,-17.896362,-2.200263,-17.594849,-2.024217,-17.26557,-1.710748,-16.914744,-1.172525,-16.664993,-0.977053,-16.82602,-0.932549,-17.217347,-1.256556,-17.728389,-1.509057,-17.86651,-1.119455,-18.110422,-0.897276,-18.403059,-0.836673,-18.657565,-0.940771,-18.865568,-1.217602,-19.095882,-1.607893,-19.267031,-1.440585,-19.643756,-1.648855,-19.891362,-1.901264,-20.326946,-1.773651,-20.424006,-1.124272,-20.447076,-0.979875,-20.559122,-0.367491,-20.40826,-0.237503,-20.31486,0.173096,-20.38441,0.311865,-20.14606,0.608933,-19.798585,0.852994,-19.803585,1.133376,-19.671303,1.369334,-19.915892,1.368407,-20.283784,1.420473,-20.449259,1.780744,-20.2444,2.879923,-19.676467,2.924888,-19.465777,3.37471,-19.381807,3.726778,-19.26809,4.174315,-19.29537,4.408961,-19.24198,4.716646,-19.011455,4.940416,-19.024565,5.135558,-18.936695,5.440805,-18.591884,5.253574,-18.256917,4.90578,-18.022548,4.757086,-17.659922,4.325421,-17.482294,3.680143,-17.400044,2.96894,-17.199763,2.858833,-16.892793,2.560534,-16.647552,2.136906,-15.652739,2.378814,-15.774248,2.653024,-16.364867,3.130642,-16.809676,3.550705,-16.951996,3.906025,-16.845587,3.760751,-16.540425,4.315599,-15.932532,4.814903,-15.851882,5.287964,-16.034279,5.342809,-16.513399,5.522437,-16.261144,5.794964,-16.183034,5.565418,-15.848148,5.005517,-15.453914,4.772431,-15.224668,4.552685,-14.86487,4.29196,-14.83257,4.122587,-15.148178,4.515999,-15.590612,3.687097,-15.323493,3.801873,-15.21432,3.543504,-14.950161,2.964634,-14.545664,2.861193,-14.175675,3.138841,-13.786387,3.347965,-13.762267,2.398204,-13.368906,2.146034,-13.188768,2.637145,-13.378,2.769315,-13.32552,2.091257,-13.045806,2.148957,-12.658293,1.987308,-12.285722,1.686849,-12.466926,2.004194,-12.053324,1.828052,-11.487782,1.817892,-11.806783,1.578512,-11.925948,1.429654,-12.260081,1.413515,-12.06701,1.740062,-11.357288,1.856582,-11.350688,2.121743,-10.80005,1.97008,-10.430414,1.600968,-10.218774,1.411773,-9.912171,1.220919,-9.843991,1.041589,-9.484399,0.669566,-9.111485,0.357439,-8.554293,0.364912,-8.224742,0.734568,-7.567211,1.365032,-6.595885,1.443992,-6.100778,1.399975,-5.79738,1.056347,-5.727954,0.755384,-5.992146,0.068696,-6.825936,0.092732,-7.146259,-0.481634,-7.692565,-0.658,-7.732205,-1.042197,-7.448159,-1.644572,-7.698756,-2.106807,-7.558258,-2.486236,-7.54503,-2.968188,-7.365427,-2.817376,-6.914498,-3.438195,-6.806071,-3.783248,-6.998733,-4.141644,-6.882806,-4.458338,-6.941611,-5.056251,-6.707023,-5.405403,-6.306533,-5.805521,-6.0444,-6.096197,-5.563969,-6.033049,-5.01697,-5.938544,-4.866533,-6.113191,-4.077136,-6.105521,-3.195286,-5.713704,-2.371844,-5.377162,-2.056631,-5.034125,-1.586069,-4.535762,-1.529984,-4.322532,-1.356773,-2.991467,-1.925381,-2.731287,-2.168188,-2.630776,-3.025713,-1.885341,-3.392339,-1.216778,-3.531956,-1.067479,-3.21871,-1.26202,-2.893426,-1.223117,-2.515276,-1.308119,-1.903621,-1.446097,-2.006645,-1.408508,-1.03136,-1.624888,-0.675899,-0.45861,-0.826838,-0.273236,-0.969847,0.501423,-1.025254,1.145459,-0.728054,1.193472,-0.395598,1.12802,0.207431,1.229584,0.541612,1.143908,1.079888,1.445159,1.511782,2.131148,1.976404,2.525772,2.111549,3.198656,1.716762,3.331985,1.541162,4.083288,1.572405,4.469736,1.782667,4.714704,1.747318,4.998385,1.338246,5.179419,1.246605,5.150495,0.662078,5.671966,0.203643,6.042192,0.164869,6.50242,-0.302661,6.66848,-0.582416,6.984216,-0.489976,6.946621,-0.193478,6.69215,-0.077567,6.943065,0.357832,6.802435,0.681552,7.059845,1.023526,7.251179,0.948085,7.276115,0.578474,7.096774,0.441702,6.991539,0.084439,7.511811,-0.239375,7.396979,-0.450127,7.51868,-0.636695,7.760807,-0.338584,8.078198,-0.404775,8.487773,-0.052689,9.352408,-0.30707,9.657207,-0.155584,10.009039,-0.179891,10.19309,-0.511104,11.237165,-0.814909,10.908342,-0.579866,11.112449,-0.392799,11.464433,-0.446187,11.846175,-0.296155,12.009883,0.06715,12.227602,-0.001754,12.74201,0.166355,13.306891,0.616958,13.786411,0.909003,14.302132,0.866413,14.647518,0.638727,15.576006,0.680977,16.320298,1.071385,16.863163,2.072968,17.084434,2.087487,17.157784,2.413608,16.942906,2.89537,17.087955,3.002106,17.772707,2.865759,17.867657,3.33932,18.098369,2.935985,19.234615,3.048074,19.44982,3.268478,19.4321,3.551179,19.81647,3.265178,20.513894,3.283916,21.003417,3.086177,21.529986,3.30277,21.991504,3.682999,22.240675,3.727966,22.497425,3.645731,22.619978,3.752228,22.844706,4.58484,22.778786,5.414686,22.644021,5.782643,22.248129,6.603052,22.065035,7.207523,21.675983,8.112134,21.678783,8.969926,21.509579,10.02146,21.400407,10.236855,21.297917,10.861404,20.929592,11.560527,20.826103,12.038131,20.552691,12.319615,20.446702,12.60969,20.105728,12.728464,19.580752,13.069799,19.328399,13.340195,18.943976,13.589325,18.508553,14.058829,18.168856,14.571527,18.075246,14.901629,18.096196,15.114945,17.858584,15.77944,17.586766,16.077865,17.088037,16.902147,16.472451,17.557758,16.24496,17.973086,15.784279,18.539509,15.364666,18.857545,14.941471,18.945405,14.658086,18.873125,14.421453,18.950115,14.245218,18.800516,14.188728,19.002485,14.567897,19.200632,14.470617,19.468077,14.646123,19.568945,14.589993,19.751588,14.167065,20.299025,13.633646,20.62153,12.947957,20.872073,12.582792,20.934203,12.615672,21.120131,12.495915,21.391747,12.521445,21.545263,12.29757,21.713592,11.948941,21.845671,11.649775,21.805791,11.50339,21.924628,11.49048,22.236061,11.694117,22.277401,11.894986,22.130739,11.954866,22.273904,11.634658,22.448005,11.332175,22.708755,11.104494,23.213712,10.804673,23.287822,10.523099,23.500822,10.386102,23.743128,10.644325,23.88186,10.921536,23.86875,10.748485,24.150215,10.353064,24.392888,10.077502,24.756655,9.782412,24.924779,9.63294,25.074377,9.653954,25.318501,9.798375,25.419507,9.436005,25.491077,9.009662,25.72798,8.907333,25.960061,8.497011,25.985361,8.208464,25.891551,7.873425,25.831911,7.801884,25.698224,7.903021,25.536132,7.770444,25.401493,7.768924,24.969129,7.923543,24.682681,8.278192,24.39758,7.793507,24.42135,8.120449,24.105711,8.263113,23.596935,8.629849,23.620105,8.854803,22.952517,8.628031,22.920887,8.497556,23.328031,8.284415,23.332131,8.556193,22.251435,8.728617,21.991745,8.63343,21.690647,8.608722,21.316033,8.766237,21.270613,9.27602,20.028979,9.444554,19.445849,9.351173,18.90574,9.466928,18.56538,9.408605,18.100134,9.636473,17.567817,9.686221,16.777856,9.866428,14.932443,9.789228,14.242349,9.651702,13.655399,9.188077,13.505591,9.133429,13.335515,8.20302,13.092183,7.33516,12.785245,6.94851,12.58598,6.709813,12.258213,6.768849,12.113706,6.293966,11.606398,5.710272,10.864433,5.12373,10.041247,4.691465,9.559089,3.899101,9.206885,4.018742,8.968635,3.711911,8.567908,3.803796,8.210494,4.133842,7.839096,4.32794,7.435869,4.188624,7.249877,4.044067,7.505886,3.721266,7.354657,3.794607,7.202058,3.637599,6.787697,3.79261,6.683461,3.956268,6.026819,3.886784,5.839039,4.424956,5.428762,4.520071,4.79057,4.750832,4.710046,5.02889,4.078995,4.832882,4.000332,4.868621,3.703252,4.678273,3.285699,4.754401,3.138856,4.599857,2.74713,4.173071,2.423245,4.111421,2.031336,3.604619,1.79434,3.045006,2.358453,3.321297,2.575953,2.931678,2.815647,2.794514,2.543575,2.585247,2.639874,2.452379,2.464032,1.849773,2.520985,1.455508,2.379042,1.456233,2.181875,0.781305,1.934058,0.70792,2.066546,0.329965,1.845732,0.288384,1.377639,-0.793069,0.660572,-0.890157,0.440639,-1.197442,0.603798,-1.851207,0.536532,-2.255079,0.409938,-2.550218,0.448877,-3.060398,0.227706,-3.662939,-0.210673,-4.318414,-0.399557,-5.144563,-0.005938,-5.83919,-0.13043,-6.291989,-0.293508,-7.174028,-0.47293,-7.697899,-0.770815,-8.415837,-0.865015,-8.617593,-1.06427,-9.109016,-1.282852,-9.46289,-1.787555,-9.289445,-2.287694,-9.645954,-2.901679,-10.032411,-3.33729,-10.460038,-3.666224,-10.663893,-3.942832,-11.088576,-4.210682,-11.026196,-4.511312,-11.462577,-4.808784,-11.553167,-5.129736,-11.762914,-5.147745,-12.152539,-5.588359,-12.457534,-6.416062,-12.437754,-6.596058,-13.0168,-6.837791,-13.0924,-6.643777,-13.04381,-6.075134,-12.447549,-5.312514,-12.383619,-5.014056,-11.953012,-4.524468,-11.830225,-4.092859,-11.602887,-3.681022,-11.581517,-3.43062,-11.385167,-3.43375,-11.067983,-3.03255,-11.319611,-2.745717,-11.432707,-3.027588,-11.7014,-3.275803,-12.195486,-3.583352,-12.231176,-4.188467,-12.675973,-4.50859,-13.055315,-4.653686,-13.266258,-4.911214,-13.080411,-4.935288,-12.902797,-5.339024,-13.171841,-5.652182,-13.381443,-5.764569,-13.730917,-6.705868,-13.858027,-7.345828,-14.222616,-7.76905,-14.515435,-7.895581,-14.821841,-7.92224,-14.890291,-8.239994,-15.122055,-8.680621,-15.254603,-9.295257,-15.471053,-9.904648,-15.418783,-10.264832,-15.512343,-10.499391,-15.345464,-10.865118,-15.246904,-11.238267,-15.237904,-11.565837,-14.99904,-11.974438,-14.677197,-12.744102,-14.528052,-13.299128,-14.481352,-13.833267,-14.419582,-13.913487,-14.095281,-13.792354,-14.092581,-13.412961,-13.988311,-13.52463,-13.910311,-13.857331,-13.910266,-14.182926,-14.343063,-14.719843,-14.701581,-14.870456,-14.663531,-15.213881,-14.512106,-15.452101,-14.712988,-15.610609,-14.585078,-15.917492,-14.686335,-16.188564,-14.578458,-16.381032,-14.709475,-16.637754,-14.561174,-16.957134,-14.607834,-17.250951,-14.469883,-17.588593,-14.885206,-17.629843,-15.001593,-17.737846,-15.035493,-18.11363,-15.267217,-18.326932,-15.482442,-18.314442,-15.595769,-18.49589,-15.605569,-18.656225,-15.805766,-18.603365,-16.005936,-18.366121,-16.294824,-18.303871,-16.697315,-18.155804,-16.51764,-18.358721,-16.141322,-18.678214,-15.92492,-18.760064,-15.87008,-18.847654,-16.191327,-18.6884,-16.486882,-18.48021,-16.872153,-18.272488,-16.960923,-18.090489,-17.296434,-17.865644,-17.742375,-17.666739,-17.913049,-17.51886,-18.229285,-17.381254,-18.413528,-17.223823,-18.656945,-17.107811,-18.689105,-17.156881,-19.218912,-16.910604,-19.429378,-16.871194,-19.383038,-16.937184,-18.985218,-17.138312,-18.723106,-17.296145,-18.58959,-17.294945,-18.411507,-17.424369,-17.823139,-17.756751,-17.550135,-18.013232,-17.303001,-18.200898,-17.506774,-18.129098,-17.474124,-18.196678,-17.64435,-18.088348,-17.519266,-18.27908,-17.665491,-18.165723,-17.519376,-18.344513,-17.732839,-18.240227,-17.775489,-18.259187,-17.4263,-18.577575,-17.34034,-18.714214,-17.489049,-18.692104,-17.313233,-18.971783,-17.103721,-19.1528,-16.981401,-19.312485,-16.746185,-19.480254,-16.495166,-19.6284,-16.282164,-19.775265,-16.236054,-19.705855,-16.007556,-19.831377,-15.997556,-19.785627,-15.833744,-19.860417,-15.672173,-20.003816,-15.637053,-20.072016,-15.445751,-20.168866,-15.629683,-20.143326,-15.731658,-20.085176,-15.687598,-20.172466,-15.80019,-20.177766,-15.76988,-20.290607,-15.627934,-20.420298,-15.442686,-20.623853,-15.225789,-20.702583,-14.939333,-20.781293,-14.901983,-20.760453,-15.10602,-20.621722,-14.984261,-20.579862,-14.783169,-20.77641,-14.690229,-20.913984,-14.38751,-21.210028,-14.30813,-21.329568,-14.074039,-21.45473,-13.994299,-21.42104,-13.755308,-21.51368,-13.546449,-21.635985,-13.307046,-21.73821,-13.215456,-21.74867,-12.942654,-21.82757,-12.921984,-21.79386,-12.623967,-21.905219,-12.619367,-21.827569,-12.751485,-21.699346,-12.64787,-21.743256,-12.55892,-21.703786,-12.65129,-21.643876,-12.60718,-21.577956,-12.493532,-21.591696,-12.443532,-21.482772,-12.292781,-21.394412,-12.114641,-21.427092,-12.074061,-21.333332,-11.900698,-21.209356,-11.882418,-21.067051,-11.793438,-21.036761,-11.564208,-21.151882,-11.330601,-21.236152,-11.191974,-21.200302,-10.886336,-21.32181,-10.618091,-21.39233,-10.646421,-21.279191,-10.490099,-21.345471,-10.336726,-21.474896,-10.279196,-21.447856,-10.289926,-21.206943,-9.946632,-21.401034,-10.111266,-21.192214,-9.904336,-21.244874,-9.784651,-21.328314,-9.630537,-21.321114,-9.505511,-21.217499,-9.058037,-21.106108,-8.895604,-21.135918,-8.770932,-21.011288,-9.081938,-20.851824,-8.822887,-20.815084,-8.354303,-20.890474,-8.187032,-20.953894,-8.084713,-20.802641,-7.834105,-20.965794,-7.952781,-21.066332,-7.802007,-21.17243,-7.450339,-21.2493,-7.224126,-21.070193,-7.022878,-21.115823,-6.74753,-21.031003,-6.459407,-21.111523,-6.199433,-21.140873,-6.187566,-21.306192,-6.02372,-21.374632,-5.764595,-21.323742,-5.797149,-21.067714,-5.657007,-21.300548,-5.513867,-21.314908,-5.412571,-21.591237,-5.578384,-21.722363,-5.756302,-21.797143,-5.698752,-22.075444,-5.492129,-22.278233,-5.299335,-22.269733,-5.153107,-22.187733,-4.945089,-21.946916,-5.094286,-21.800752")

state="start"
stst=0

#include super-extinction-event.p8:1
#include super-extinction-event.p8:4

--crop vector data
function cvd (xs,c)
	local z={}
	for i=1,#xs do
		add(z,mid(-c,xs[i],c))
	end	
	return z
end

function _init()
		
	e={x=0,y=0,a=0,r=0,s=.01,d=1,c=2,
		enabled=true,
		fr=1,frames={earth2c}}	
	e.scale=100
	
	tree={x=0,y=0,a=0,r=0,d=1,c=11,
	enabled=true,scale=1,
	fr=1,frames={translate(treepts,-5,0)}}

	bronto_idle=translate(bronto_idle,5,0)
	bronto_run1=translate(bronto_run1,5,0)
	bronto_run2=translate(bronto_run2,5,0)
	
	bronto={x=-70,y=0,a=0,r=0,d=1,c=15,
	enabled=true,scale=1,
	fr=1,frames={bronto_idle,bronto_run1,bronto_run2,}}

	
	for i=1,100 do
		add(stars,{
			x=rnd()*256-128,
			y=rnd()*256-128,
			z=rnd()*128
		})
	end
	
end

function _update()

	⧗+=1
	
	if state=="start" then
		bronto.x+=1
		bronto.fr=⧗%8>3 and 2 or 3
		if bronto.x>0 then
			bronto.x=0
			bronto.fr=1
			state="munch"
			stst=⧗
		end
	end
	
	if state=="munch" then
		tree.r=rnd()*.01
		if ⧗-stst>60 then
			state="zoomout1"
			stst=⧗
		end
	end
	
	if state=="zoomout1" then
		bronto.scale-=.01
		tree.scale-=.01
		tree.r=rnd()*.01
		if bronto.scale<.01 then
			state="zoomout2"
			stst=⧗
			bronto.enabled=false
			tree.enabled=false
		end
	end

	if ⧗>500 then
		e.scale-=.25
	end
	if e.scale<1 then e.scale=1 end
	crop=72/e.scale
	e.frames={cvd(earth2f,crop)}

	if e.scale==1 then
		l⧗+=1
		
		if l⧗==1 then
			addword("extinction",-74,-6)
		end
	
		if contains({60,70,80},l⧗) then
			addword("super",-36,-26)
		end
		
		if contains({80,90,100},l⧗) then
			addword("event",-36,16)
		end
	end


	for star in all(stars) do
		star.z-=2
		if star.z<1 then
			star.x=rnd()*256-128
			star.y=rnd()*256-128
			star.z=128
		end
	end
	
	for seg in all(segs) do
		for p in all(seg) do
			if p.z<192 then p.z+=3 end
		end
	end
	
end

function _draw()
	cls()
	
	camera(-64,-64)
	
	for star in all(stars) do
		local x,y=zoom(star)
		local r=(1-star.z/128)*2
		circfill(x,y,r,7)
	end
	
	circfill(0,0,29*e.scale,0)
	circ(0,0,29*e.scale,e.c)

	render_ent(e)
	render_ent(tree)
	render_ent(bronto)
	
	color(8)
	for seg in all(segs) do		
		local x1,y1=zoom(seg[1])
		local x2,y2=zoom(seg[2])
		line(x1,y1,x2,y2)

		for i=3,#seg do
			line(zoom(seg[i]))
		end
	end

pal(split("129,130,14,132,133,134,135,136,137,138,139,140,141,142,143,0"),1)

camera()
--print("crop: "..crop,0,10,12)
--print("escale: "..e.scale,0,20,12)

end

function zoom (e)
	local x1=(e.x/e.z)*128
	local y1=(e.y/e.z)*128
	return x1,y1
end

function addword (str,xoff,yoff)
	local word=str
--	local xoff,yoff=-76,-6
	
	for i=1,#word do
		local letter=fonts[word[i]]
		local seg={}

		for pair in all(letter) do			
			if pair==font_up then
				add(segs,seg)
				seg={}
			else
				add(seg,{
					x=pair[1]+xoff,
					y=12-pair[2]+yoff,
--					z=256
					z=0
				})
			end
		end
		add(segs,seg)
		
		xoff=xoff+16
	end
	
end
-->8
--font data
-- https://trmm.net/asteroids_font
-- "draw" command
font_up={}
fonts={
	['0'] = { {0,0}, {8,0}, {8,12}, {0,12}, {0,0}, {8,12}},
	['1'] = { {4,0}, {4,12}, {3,10}},
	['2'] = { {0,12}, {8,12}, {8,7}, {0,5}, {0,0}, {8,0}},
	['3'] = { {0,12}, {8,12}, {8,0}, {0,0}, font_up, {0,6}, {8,6}},
	['4'] = { {0,12}, {0,6}, {8,6}, font_up, {8,12}, {8,0}},
	['5'] = { {0,0}, {8,0}, {8,6}, {0,7}, {0,12}, {8,12}},
	['6'] = { {0,12}, {0,0}, {8,0}, {8,5}, {0,7}},
	['7'] = { {0,12}, {8,12}, {8,6}, {4,0}},
	['8'] = { {0,0}, {8,0}, {8,12}, {0,12}, {0,0}, font_up, {0,6}, {8,6}, },
	['9'] = { {8,0}, {8,12}, {0,12}, {0,7}, {8,5}},
	[' '] = { },
	['.'] = { {3,0}, {4,0}},
	[','] = { {2,0}, {4,2}},
	['-'] = { {2,6}, {6,6}},
	['+'] = { {1,6}, {7,6}, font_up, {4,9}, {4,3}},
	['!'] = { {4,0}, {3,2}, {5,2}, {4,0}, font_up, {4,4}, {4,12}},
	['#'] = { {0,4}, {8,4}, {6,2}, {6,10}, {8,8}, {0,8}, {2,10}, {2,2} },
	['^'] = { {2,6}, {4,12}, {6,6}},
	['='] = { {1,4}, {7,4}, font_up, {1,8}, {7,8}},
	['*'] = { {0,0}, {4,12}, {8,0}, {0,8}, {8,8}, {0,0}},
	['_'] = { {0,0}, {8,0}},
	['/'] = { {0,0}, {8,12}},
	['\\'] = { {0,12}, {8,0}},
	['@'] = { {8,4}, {4,0}, {0,4}, {0,8}, {4,12}, {8,8}, {4,4}, {3,6} },
	['$'] = { {6,2}, {2,6}, {6,10}, font_up, {4,12}, {4,0}},
	['&'] = { {8,0}, {4,12}, {8,8}, {0,4}, {4,0}, {8,4}},
	['['] = { {6,0}, {2,0}, {2,12}, {6,12}},
	[']'] = { {2,0}, {6,0}, {6,12}, {2,12}},
	['('] = { {6,0}, {2,4}, {2,8}, {6,12}},
	[')'] = { {2,0}, {6,4}, {6,8}, {2,12}},
	['{'] = { {6,0}, {4,2}, {4,10}, {6,12}, font_up, {2,6}, {4,6}},
	['}'] = { {4,0}, {6,2}, {6,10}, {4,12}, font_up, {6,6}, {8,6}},
	['%'] = { {0,0}, {8,12}, font_up, {2,10}, {2,8}, font_up, {6,4}, {6,2} },
	['<'] = { {6,0}, {2,6}, {6,12}},
	['>'] = { {2,0}, {6,6}, {2,12}},
	['|'] = { {4,0}, {4,5}, font_up, {4,6}, {4,12}},
	[':'] = { {4,9}, {4,7}, font_up, {4,5}, {4,3}},
	[';'] = { {4,9}, {4,7}, font_up, {4,5}, {1,2}},
	['"'] = { {2,10}, {2,6}, font_up, {6,10}, {6,6}},
	['\''] = { {2,6}, {6,10}},
	['`'] = { {2,10}, {6,6}},
	['~'] = { {0,4}, {2,8}, {6,4}, {8,8}},
	['?'] = { {0,8}, {4,12}, {8,8}, {4,4}, font_up, {4,1}, {4,0}},
	['a'] = { {0,0}, {0,8}, {4,12}, {8,8}, {8,0}, font_up, {0,4}, {8,4} },
	['b'] = { {0,0}, {0,12}, {4,12}, {8,10}, {4,6}, {8,2}, {4,0}, {0,0} },
	['c'] = { {8,0}, {0,0}, {0,12}, {8,12}},
	['d'] = { {0,0}, {0,12}, {4,12}, {8,8}, {8,4}, {4,0}, {0,0}},
	['e'] = { {8,0}, {0,0}, {0,12}, {8,12}, font_up, {0,6}, {6,6}},
	['f'] = { {0,0}, {0,12}, {8,12}, font_up, {0,6}, {6,6}},
	['g'] = { {6,6}, {8,4}, {8,0}, {0,0}, {0,12}, {8,12}},
	['h'] = { {0,0}, {0,12}, font_up, {0,6}, {8,6}, font_up, {8,12}, {8,0} },
	['i'] = { {0,0}, {8,0}, font_up, {4,0}, {4,12}, font_up, {0,12}, {8,12} },
	['j'] = { {0,4}, {4,0}, {8,0}, {8,12}},
	['k'] = { {0,0}, {0,12}, font_up, {8,12}, {0,6}, {6,0}},
	['l'] = { {8,0}, {0,0}, {0,12}},
	['m'] = { {0,0}, {0,12}, {4,8}, {8,12}, {8,0}},
	['n'] = { {0,0}, {0,12}, {8,0}, {8,12}},
	['o'] = { {0,0}, {0,12}, {8,12}, {8,0}, {0,0}},
	['p'] = { {0,0}, {0,12}, {8,12}, {8,6}, {0,5}},
	['q'] = { {0,0}, {0,12}, {8,12}, {8,4}, {0,0}, font_up, {4,4}, {8,0} },
	['r'] = { {0,0}, {0,12}, {8,12}, {8,6}, {0,5}, font_up, {4,5}, {8,0} },
	['s'] = { {0,2}, {2,0}, {8,0}, {8,5}, {0,7}, {0,12}, {6,12}, {8,10} },
	['t'] = { {0,12}, {8,12}, font_up, {4,12}, {4,0}},
	['u'] = { {0,12}, {0,2}, {4,0}, {8,2}, {8,12}},
	['v'] = { {0,12}, {4,0}, {8,12}},
	['w'] = { {0,12}, {2,0}, {4,4}, {6,0}, {8,12}},
	['x'] = { {0,0}, {8,12}, font_up, {0,12}, {8,0}},
	['y'] = { {0,12}, {4,6}, {8,12}, font_up, {4,6}, {4,0}},
	['z'] = { {0,12}, {8,12}, {0,0}, {8,0}, font_up, {2,6}, {6,6}},
}
local font_scale=6
function draw_char(c,x,y,scale)
	scale=scale or font_scale
	local font=fonts[c]
	if(not font) assert("unsupported char:"..c)
	local x0,y0
	local moveto=true
	for i=1,#font do
		local seg=font[i]
		if seg==font_up then
			moveto=true
			goto continue
		end
		if moveto==true then
			x0,y0=seg[1],12-seg[2]
			moveto=false
		else
			local x1,y1=seg[1],12-seg[2]
			line(
				x+scale*x0/12,
				y+scale*y0/12,
				x+scale*x1/12,
				y+scale*y1/12)
			x0,y0=x1,y1
		end
		::continue::
	end
end
-->8
--sprites
bronto_idle=split("-4.3165,-4.0968,-8.3866,-3.0792,-2.2815,-10.2019,1.7886,-10.2019,3.8236,-20.377,7.8937,-20.377,7.8937,-17.3245,5.8587,-17.3245,4.8412,-9.1843,4.3324,-1.0442,2.8061,-1.2986,1.7886,-4.0968,-1.2639,-4.0968,-1.7727,-1.0442,-3.299,-0.7898")
bronto_run1=split("-4.3385,-3.7286,-8.6183,-3.7286,-2.1985,-10.1484,2.0814,-10.1484,6.3612,-16.5683,10.6411,-16.5683,10.6411,-13.3584,8.5012,-13.3584,5.2913,-9.0785,7.9662,-1.5887,6.3612,-0.7862,2.0814,-3.7286,-1.1285,-3.7286,-3.8035,-0.5187,-5.4084,-0.2512")
bronto_run2=split("-4.377,-3.6942,-8.698,-3.6942,-2.2166,-10.1757,2.1044,-10.1757,6.4254,-16.6572,10.7464,-16.6572,10.7464,-13.4164,8.5859,-13.4164,5.3452,-9.0955,3.7248,-0.4535,1.0242,-0.7236,2.1044,-3.6942,-1.1363,-3.6942,-0.5962,-0.4535,-3.2968,-0.1834")

treepts=split("3.62,-8.69,3.04,-10.49,12.04,-11.49,10.04,-15.49,3.04,-16.49,2.04,-14.49,0.56,-18.11,-1.87,-19.29,-9.1,-16.13,-9.48,-13.86,-7.96,-11.49,-5.96,-13.49,0.04,-11.49,-1.66,-9.52,-2.83,-5.74,-3.07,0.17,-0.96,5.51,4.04,4.4,2.78,-0.14,2.92,-5.38,3.62,-8.69")

pteropts1=split("-9.49,2.5,-1.18,-2.28,-0.49,-8.5,3.91,-0.48,5.51,-1.5,4.51,-4.5,7.51,-3.5,9.51,-1.5,12.51,0.5,7.51,0.5,5.9,1.66,3.51,1.5,0.41,3.03,-1.62,0.75,-2.49,1.5,-4.53,1.14,-9.49,2.5")
pteropts2=split("-10.49,1.5,-2.18,-3.28,2.91,-1.48,4.51,-2.5,3.51,-5.5,6.51,-4.5,8.51,-2.5,11.51,-0.5,6.51,-0.5,4.9,0.66,2.51,0.5,6.51,3.5,4.51,3.5,1.02,8.36,-1.44,3.97,-0.59,2.03,-2.62,-0.25,-3.49,0.5,-5.53,0.14,-10.49,1.5")

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
